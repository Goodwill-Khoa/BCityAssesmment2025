{% extends "base.html" %}
{% block content %}
<h2>Update Database</h2>
<form method="get" action="{{ url_for('admin.update_database') }}">
  <button name="db" value="contact" type="submit" {% if db_choice == 'contact' %}disabled{% endif %}>Contact DB</button>
  <button name="db" value="client" type="submit" {% if db_choice == 'client' %}disabled{% endif %}>Client DB</button>
</form>
{% if db_choice %}
  <h3>{{ db_choice|capitalize }} Table</h3>
  {% if records and columns %}
  <table border="1">
    <tr>
      {% for col in columns %}
        <th>{{ col }}</th>
      {% endfor %}
      <th>Actions</th>
    </tr>
    {% for record in records %}
    <tr>
      <form method="post" action="{{ url_for('admin.update_delete_record', model_name=db_choice, record_id=record.id) }}">
        {% for col in columns %}
        <td>
          <input name="{{ col }}" value="{{ record | attribute(col) }}" {% if col == 'id' %}readonly{% endif %}>
        </td>
        {% endfor %}
        <td>
          <button name="action" value="update" type="submit">Update</button>
          <button name="action" value="delete" type="submit" onclick="return confirm('Delete this record?');">Delete</button>
        </td>
      </form>
    </tr>
    {% endfor %}
  </table>
  {% else %}
    <p>No records found.</p>
  {% endif %}
{% endif %}
{% endblock %}